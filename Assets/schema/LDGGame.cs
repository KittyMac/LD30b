

//
// Autogenerated by gaxb ( https://github.com/SmallPlanet/gaxb )
//
using System.Collections.Generic;
using System;
using UnityEngine;

public partial class LDGGame : LDGGameBase {

	public static LDGGame CreateGame() {
		LDGGame game = new LDGGame();
		game.SetSaveGameTag (5);


		// 0) Load all equipment
		List<LDGEquipment> allEquipment = LDGAllEquipment.GetAllEquipment ();

		// 1) put random copies of all equipment into game.Equipment (this is the stuff floating in space)
		// 1a) Should at least be one of everything
		foreach (LDGEquipment equipment in allEquipment) {
			game.AddSpaceEquipment (equipment);
		}

		// 1b) Now add more random copies for fun
		int copies = UnityEngine.Random.Range (allEquipment.Count, allEquipment.Count * 3);
		for (int i = 0; i < copies; i++) {
			LDGEquipment equipment = allEquipment [UnityEngine.Random.Range (0, allEquipment.Count)];
			game.AddSpaceEquipment (equipment);
		}


		// 2) add the planets
		LDGPlanet redPlanet = new LDGPlanet(100.0f, 0.0f);
		LDGPlanet bluePlanet = new LDGPlanet(100.0f, 0.0f);
		redPlanet.parent = game;
		bluePlanet.parent = game;
		game.Planets.Add (bluePlanet);
		game.Planets.Add (redPlanet);

		return game;
	}

	public void AddSpaceEquipment(LDGEquipment equipment) {
		LDGEquipment clone = equipment.Clone ();
		clone.position = new cVector3 (UnityEngine.Random.Range (96, 750), UnityEngine.Random.Range (38, 532), 0);
		Equipments.Add (clone);
	}

	public LDGPlanet redPlanet()
	{
		return Planets [1] as LDGPlanet;
	}

	public LDGPlanet bluePlanet()
	{
		return Planets [0] as LDGPlanet;
	}

	public bool AddEquipmentToPlanetBuildQueue(LDGEquipment e, LDGPlanet p) {

		if (p.Equipments.Count > 13) {
			return false;
		}

		// 0 remove the equipment from space
		Equipments.Remove (e);

		// 1 add it to the planet
		p.Equipments.Add (e);

		return true;
	}

	public void BuildCurrentShipForPlanet(LDGPlanet p) {
		LDGShip ship = new LDGShip();
		Vector3 exitPos = new Vector3 (934,28,0);

		ship.player = 0;

		if (p == redPlanet ()) {
			ship.player = 1;
			exitPos = new Vector3 (25,583,0);
		}

		ship.Equipments.AddRange (p.Equipments);
		p.Equipments.Clear ();

		ship.InitCombatValues ();

		float anim = 0.0f;
		foreach (LDGEquipment e in ship.Equipments) {
			e.RemoveSprite (anim, exitPos);
			anim += 1.0f / ship.Equipments.Count;
		}

		p.AddShipToBuild (ship);
	}

	public void AdvanceGame (PUGameObject ShipsContainer){
		foreach (LDGPlanet p in Planets) {
			p.AdvanceBuildQueue (ShipsContainer);
		}
	}
}
